{"version":3,"sources":["pages/demo/ajax/index.jsx"],"names":["config","path","props","useState","loading","setLoading","pageNum","setPageNum","time","setTime","useGet","successTip","fetchUser","run","data","name","error","users","formatResult","res","users2","console","log","a","ajax","download","onClick","Date","now","JSON","stringify"],"mappings":"wOAMeA,sBAAO,CAClBC,KAAM,cADKD,EAEZ,SAAkBE,GAAQ,IAAD,EACMC,qBADN,mBACjBC,EADiB,KACRC,EADQ,OAEMF,mBAAS,GAFf,mBAEjBG,EAFiB,KAERC,EAFQ,OAGAJ,qBAHA,mBAGjBK,EAHiB,KAGXC,EAHW,OAQpBC,YAAO,OAAQ,CAACJ,UAASE,QAAO,CAACG,WAAY,2BAAQN,eAHhDO,EALe,EAKpBC,IALoB,IAMpBC,YANoB,MAMb,CAACC,KAAM,QANM,EAOpBC,EAPoB,EAOpBA,MAKSC,EAASP,YAAO,OAAQ,CAACJ,UAASE,QAAO,CAACF,GAAU,CAC7DD,aACAa,aAAc,SAAAC,GACV,OAAKA,EAEEA,EAAIL,KAFM,MAHlBA,KAUMM,EAAUV,YAAO,OAAQ,CAACJ,UAASE,QAAO,CAACF,IAAU,SAAAa,GAE9D,OADAE,QAAQC,IAAI,qDACPH,EAEEA,EAAIL,KAFM,MAFdA,KAtBiB,4CA6BxB,sBAAAS,EAAA,sEACUX,EAAU,CAACG,KAAM,QAD3B,4CA7BwB,kEAiCxB,sBAAAQ,EAAA,sDACIrB,EAAMsB,KAAKC,SAAS,aADxB,4CAjCwB,sBAyCxB,OAHAJ,QAAQC,IAAI,mBACZD,QAAQC,IAAI,QAASL,GACrBI,QAAQC,IAAI,SAAUF,GAElB,eAAC,IAAD,WACI,mDADJ,iCAEUZ,EACN,uBACA,8BACI,mBAAQkB,QA/CI,2CA+CZ,iBACA,mBAAQA,QAAS,kBAAMnB,EAAWD,EAAU,IAA5C,gCACA,mBAAQoB,QAAS,kBAAMjB,EAAQkB,KAAKC,QAApC,sCACA,mBAAQF,QAlDI,2CAkDZ,yCAEJ,4CAAetB,EAAU,uCAAW,MACpC,4DACI,+BACI,8BACCyB,KAAKC,UAAUhB,EAAM,KAAM,UAIpC,4DACI,+BACI,8BACCe,KAAKC,UAAUd,EAAO,KAAM","file":"static/js/20.34cf263b.chunk.js","sourcesContent":["import {useState} from 'react';\nimport {Button, Space} from 'antd';\nimport {useGet} from 'src/commons/ajax';\nimport config from 'src/commons/config-hoc';\nimport {PageContent} from '@ra-lib/components';\n\nexport default config({\n    path: '/demo/ajax',\n})(function TestAjax(props) {\n    const [loading, setLoading] = useState();\n    const [pageNum, setPageNum] = useState(1);\n    const [time, setTime] = useState();\n    const {\n        run: fetchUser,\n        data = {name: 'init'},\n        error,\n    } = useGet('/get', {pageNum, time}, {successTip: '请求成功', setLoading});\n\n    // 初始化时、pageNum改变时 发起请求\n    // 这种方式估计会用的多\n    const {data: users} = useGet('/get', {pageNum, time}, [pageNum], {\n        setLoading, // 多个请求公用一个loading情况\n        formatResult: res => {\n            if (!res) return {};\n\n            return res.data;\n        },\n    });\n\n    // 初始化时、pageNum改变时 发起请求\n    const {data: users2} = useGet('/get', {pageNum, time}, [pageNum], res => {\n        console.log('initOptions 直接作为 formatResult');\n        if (!res) return {};\n\n        return res.data;\n    });\n\n    async function handleGet() {\n        await fetchUser({name: '123'});\n    }\n\n    async function handleDownload() {\n        props.ajax.download('/download');\n        // window.open('/api/download'); // 1. 瞬间打开新窗口，然后又关闭；2. 只支持get；3. 需要自己拼接 api前缀\n    }\n\n    console.log('TestAjax render');\n    console.log('users', users);\n    console.log('users2', users2);\n    return (\n        <PageContent>\n            <h2>Ajax 测试</h2>\n            当前时间：{time}\n            <br/>\n            <Space>\n                <Button onClick={handleGet}>get</Button>\n                <Button onClick={() => setPageNum(pageNum + 1)}>下一页</Button>\n                <Button onClick={() => setTime(Date.now())}>设置时间</Button>\n                <Button onClick={handleDownload}>下载文件</Button>\n            </Space>\n            <div>loading: {loading ? '请求中。。。' : ''}</div>\n            <div>成功结果:\n                <code>\n                    <pre>\n                    {JSON.stringify(data, null, 4)}\n                    </pre>\n                </code>\n            </div>\n            <div>失败结果:\n                <code>\n                    <pre>\n                    {JSON.stringify(error, null, 4)}\n                    </pre>\n                </code>\n            </div>\n        </PageContent>\n    );\n});\n"],"sourceRoot":""}