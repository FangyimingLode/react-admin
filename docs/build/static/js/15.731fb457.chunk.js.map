{"version":3,"sources":["commons/use-options/index.js","commons/use-options/demo.js","pages/local/UseOptions.jsx"],"names":["useOptions","args","useState","result","setResult","useEffect","a","functions","map","item","res","then","Promise","resolve","allSettled","results","options","status","value","console","error","reason","filter","forEach","arr","obj","keys","Object","length","includes","Error","JSON","stringify","yesNo","label","sex","menu","action","UseOptionsDemo","props","yesNoOptions","sexOptions","menuOptions","actionOptions","menuOptions1","actionOptions1","config","path"],"mappings":"yLA8Be,SAASA,IAAqB,IAAD,uBAANC,EAAM,yBAANA,EAAM,sBACZC,mBAAS,IADG,mBACjCC,EADiC,KACzBC,EADyB,KA4CxC,OA1CAC,qBAAU,WACN,sBAAC,4BAAAC,EAAA,sDACSC,EAAYN,EAAKO,KAAI,SAAAC,GACvB,GAAoB,oBAATA,EAAqB,CAC5B,IAAMC,EAAMD,IAEZ,OAAIC,EAAIC,KAAaD,EAGdE,QAAQC,QAAQH,GAI3B,OAAOE,QAAQC,QAAQJ,MAE3BG,QAAQE,WAAWP,GACdI,MAAK,SAAAI,GACF,IAAMC,EAAUD,EAAQP,KAAI,SAAAC,GACxB,MAAoB,cAAhBA,EAAKQ,OACER,EAAKS,OAEZC,QAAQC,MAAMX,EAAKY,QACZ,OAKfL,EAAQM,QAAO,SAAAb,GAAI,QAAMA,KAAMc,SAAQ,SAAAC,GAAG,OAAIA,EAAID,SAAQ,SAAAE,GACtD,IAAMC,EAAOC,OAAOD,KAAKD,GACzB,GAAIC,EAAKE,OAAS,GAAsB,IAAhBF,EAAKE,SAAiBF,EAAKG,SAAS,UACxD,MAAMC,MAAM,yHAA2CC,KAAKC,UAAUP,EAAK,KAAM,IAErF,IAAKC,EAAKG,SAAS,WAAaH,EAAKG,SAAS,SAC1C,MAAMC,MAAM,sGAAkCC,KAAKC,UAAUP,EAAK,KAAM,UAGhFrB,EAAUY,MAnCrB,0CAAD,KAuCD,IAEIb,EArEXH,EAAWiC,MAAQ,CACf,CAACf,OAAO,EAAMgB,MAAO,UACrB,CAAChB,OAAO,EAAOgB,MAAO,WAI1BlC,EAAWmC,IAAM,CACb,CAACjB,MAAO,IAAKgB,MAAO,UACpB,CAAChB,MAAO,IAAKgB,MAAO,UACpB,CAAChB,MAAO,IAAKgB,MAAO,iBAIxBlC,EAAWoC,KAAX,sBAAkB,sBAAA9B,EAAA,+EACP,CACH,CAACY,MAAO,IAAKgB,MAAO,4BACpB,CAAChB,MAAO,IAAKgB,MAAO,8BAHV,2CAOlBlC,EAAWqC,OAAX,sBAAoB,sBAAA/B,EAAA,4DAEVwB,MAAM,kCAFI,2C,WCtBL,SAASQ,EAAeC,GAAO,IAG5BC,EAAiCxC,EAAxCiC,MAA0BQ,EAAczC,EAAnBmC,IAHc,EAMpBnC,EAAWA,EAAWoC,MAArCM,EANmC,sBAOlB1C,EAAWA,EAAWqC,QAAvCM,EAPmC,sBAatC3C,EACAA,EAAWoC,KACXpC,EAAWqC,QAf2B,mBAWtCO,EAXsC,KAYtCC,EAZsC,KAkB1C,OACI,cAAC,IAAD,UACI,8BACCd,KAAKC,UAAU,CACZQ,eACAC,aACAC,cACAC,gBACAC,eACAC,kBACD,KAAM,OC5BNC,sBAAO,CAClBC,KAAM,eADKD,EAEZ,SAAoBP,GAEnB,OAAO,cAACD,EAAD","file":"static/js/15.731fb457.chunk.js","sourcesContent":["import {useEffect, useState} from 'react';\n// 项目中可能用到的一些枚举类数据\n// 约定只含有三个参数，其他数据通过record存储：{value: 1, label: '名称', record: {}};\n\n// 是否\nuseOptions.yesNo = [\n    {value: true, label: '是'},\n    {value: false, label: '否'},\n];\n\n// 性别\nuseOptions.sex = [\n    {value: '1', label: '男'},\n    {value: '2', label: '女'},\n    {value: '3', label: '未知'},\n];\n\n// 可以是函数，异步或同步都可以\nuseOptions.menu = async () => {\n    return [\n        {value: '1', label: '用户管理'},\n        {value: '2', label: '菜单管理'},\n    ];\n};\n\nuseOptions.action = async () => {\n\n    throw Error('获取失败了');\n};\n\nexport default function useOptions(...args) {\n    const [result, setResult] = useState([]);\n    useEffect(() => {\n        (async () => {\n            const functions = args.map(item => {\n                if (typeof item === 'function') {\n                    const res = item();\n                    // 异步函数结果\n                    if (res.then) return res;\n\n                    // 同步函数结果\n                    return Promise.resolve(res);\n                }\n\n                // 不是函数，原样返回\n                return Promise.resolve(item);\n            });\n            Promise.allSettled(functions)\n                .then(results => {\n                    const options = results.map(item => {\n                        if (item.status === 'fulfilled') {\n                            return item.value;\n                        } else {\n                            console.error(item.reason);\n                            return [];\n                        }\n                    });\n\n                    // 检测是否只含有 value label record? 三个参数\n                    options.filter(item => !!item).forEach(arr => arr.forEach(obj => {\n                        const keys = Object.keys(obj);\n                        if (keys.length > 3 || (keys.length === 3 && !keys.includes('record')))\n                            throw Error('枚举类型数据，只能含有 value,label,record 三个属性！\\n' + JSON.stringify(obj, null, 4));\n\n                        if (!keys.includes('value') || !keys.includes('label'))\n                            throw Error('枚举类型数据，必须含有 value,label 属性！\\n' + JSON.stringify(obj, null, 4));\n                    }));\n\n                    setResult(options);\n                });\n        })();\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []);\n\n    return result;\n}\n","import {PageContent} from '@ra-lib/components';\nimport useOptions from 'src/commons/use-options';\n\nexport default function UseOptionsDemo(props) {\n\n    // 直接获取\n    const {yesNo: yesNoOptions, sex: sexOptions} = useOptions;\n\n    // 发请求获取\n    const [menuOptions] = useOptions(useOptions.menu);\n    const [actionOptions] = useOptions(useOptions.action);\n\n    // 多个按顺序对应\n    const [\n        menuOptions1,\n        actionOptions1,\n    ] = useOptions(\n        useOptions.menu,\n        useOptions.action,\n    );\n\n    return (\n        <PageContent>\n            <pre>\n            {JSON.stringify({\n                yesNoOptions,\n                sexOptions,\n                menuOptions,\n                actionOptions,\n                menuOptions1,\n                actionOptions1,\n            }, null, 4)}\n            </pre>\n        </PageContent>\n    );\n}\n","import config from 'src/commons/config-hoc';\nimport UseOptionsDemo from 'src/commons/use-options/demo';\n\nexport default config({\n    path: '/useOptions',\n})(function UseOptions(props) {\n\n    return <UseOptionsDemo/>;\n});\n"],"sourceRoot":""}