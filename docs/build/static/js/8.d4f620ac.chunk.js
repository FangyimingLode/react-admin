(this["webpackJsonpant-admin"]=this["webpackJsonpant-admin"]||[]).push([[8],{786:function(e,n,t){"use strict";t.r(n);var a,r=t(61),o=t.n(r),i=(t(415),t(284)),l=(t(234),t(77)),c=t(88),s=t(28),u=(t(802),t(803)),A=t(109),d=t(0),f=t(164),p=t(1016),b=t(1017),m=t(790),x=t(845),j=t(1023),g=t(1018),y=t(1015),O=t(1019),h=t(882),v=t(7),C=Object(f.a)({modal:function(e){return e.isEdit?"\u7f16\u8f91\u89d2\u8272":"\u521b\u5efa\u89d2\u8272"}})((function(e){var n=e.id,t=e.isEdit,a=e.onOk,r=Object(d.useState)(!1),i=Object(A.a)(r,2),l=i[0],f=i[1],p=u.a.useForm(),b=Object(A.a)(p,1)[0],m=e.ajax.useGet("/roles/".concat(n),null,{setLoading:f,formatResult:function(e){e&&b.setFieldsValue(e)}}).run,x=e.ajax.usePost("/roles",null,{setLoading:f,successTip:"\u521b\u5efa\u6210\u529f\uff01"}).run,g=e.ajax.usePut("/roles",null,{setLoading:f,successTip:"\u4fee\u6539\u6210\u529f\uff01"}).run;function y(){return(y=Object(c.a)(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(JSON.stringify(n,null,4)),!t){e.next=6;break}return e.next=4,g(n);case 4:e.next=8;break;case 6:return e.next=8,x(n);case 8:a();case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(d.useEffect)((function(){t&&m()}),[]);var O={labelCol:{flex:"100px"}};return Object(v.jsx)(h.a,{loading:l,okText:"\u4fdd\u5b58",onOk:function(){return b.submit()},cancelText:"\u91cd\u7f6e",onCancel:function(){return b.resetFields()},children:Object(v.jsxs)(u.a,{form:b,name:"roleEdit",onFinish:function(e){return y.apply(this,arguments)},children:[t?Object(v.jsx)(j.a,{hidden:!0,name:"id",initialValue:n}):null,Object(v.jsx)(j.a,Object(s.a)(Object(s.a)({},O),{},{label:"\u89d2\u8272\u540d\u79f0",name:"name",required:!0,noSpace:!0})),Object(v.jsx)(j.a,Object(s.a)(Object(s.a)({},O),{},{type:"textarea",label:"\u89d2\u8272\u63cf\u8ff0",name:"description",maxLength:50}))]})})})),w=t(129),E=t(199),k=t(189),S=t(190),R=t(200),_=t(197),T=t(31),I=t(387),H=(t(837),Object(f.a)({ajax:!0})(a=function(e){Object(R.a)(t,e);var n=Object(_.a)(t);function t(){var e;Object(k.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=n.call.apply(n,[this].concat(r))).state={loading:!1,menus:[],allMenuKeys:[],expandedRowKeys:[]},e.columns=[{title:"\u6807\u9898",dataIndex:"title",key:"title"},{title:"\u7c7b\u578b",dataIndex:"type",key:"type",width:80,render:function(e,n){return n.target?"\u7ad9\u5916\u83dc\u5355":"1"===e?"\u7ad9\u5185\u83dc\u5355":"2"===e?"\u529f\u80fd":"\u83dc\u5355"}}],e.handleSelect=function(n,t){var a,r,o=e.props.value,i=void 0===o?[]:o,l=e.state.menus,c=n.id,s=Object(E.a)(i),u=Object(T.d)(l,c).map((function(e){return e.id})),A=n.parentKeys,d=void 0===A?[]:A;t?s=(r=s=(a=s).concat.apply(a,[c].concat(Object(E.a)(u)))).concat.apply(r,Object(E.a)(d)):(s=s.filter((function(e){return![c].concat(Object(E.a)(u)).includes(e)})),d.reverse().forEach((function(e){Object(T.d)(l,e).map((function(e){return e.id})).some((function(e){return s.includes(e)}))?s.push(e):s=s.filter((function(n){return n!==e}))})));var f=e.props.onChange;f&&f(Array.from(new Set(s)))},e.handleSelectAll=function(n){var t=e.state.allMenuKeys,a=e.props.onChange;a&&a(n?t:[])},e}return Object(S.a)(t,[{key:"componentDidMount",value:function(){this.handleSearch()}},{key:"handleSearch",value:function(){var e=this;this.setState({loading:!0}),Object(I.a)().then((function(n){var t=n,a=t.map((function(e){return e.id})),r=Object(T.b)(t),o=Object(E.a)(a);e.setState({menus:r,allMenuKeys:a,expandedRowKeys:o})})).finally((function(){return e.setState({loading:!1})}))}},{key:"render",value:function(){var e=this,n=this.state,t=n.menus,a=n.loading,r=n.expandedRowKeys,o=this.props,i=o.value,l=(o.onChange,Object(w.a)(o,["value","onChange"]));return Object(v.jsx)(y.a,Object(s.a)({expandable:{expandedRowKeys:r,onExpandedRowsChange:function(n){return e.setState({expandedRowKeys:n})}},rowSelection:{selectedRowKeys:i,onSelect:this.handleSelect,onSelectAll:this.handleSelectAll},loading:a,columns:this.columns,dataSource:t,pagination:!1,rowKey:"id"},l))}}]),t}(d.Component))||a),P=t(989),J=t.n(P);n.default=Object(f.a)({path:"/roles"})((function(e){var n=Object(d.useState)(!1),t=Object(A.a)(n,2),a=t[0],r=t[1],f=Object(d.useState)(1),h=Object(A.a)(f,2),w=h[0],E=h[1],k=Object(d.useState)(20),S=Object(A.a)(k,2),R=S[0],_=S[1],T=Object(d.useState)({}),I=Object(A.a)(T,2),P=I[0],B=I[1],K=Object(d.useState)([]),D=Object(A.a)(K,2),F=D[0],N=D[1],M=Object(d.useState)([]),L=Object(A.a)(M,2),G=L[0],Q=L[1],V=Object(d.useState)(null),X=Object(A.a)(V,2),Y=X[0],W=X[1],z=Object(d.useState)(!1),q=Object(A.a)(z,2),U=q[0],$=q[1],Z=u.a.useForm(),ee=Object(A.a)(Z,1)[0],ne=Object(d.useState)(null),te=Object(A.a)(ne,2),ae=te[0],re=te[1],oe=Object(s.a)(Object(s.a)({},P),{},{pageNum:w,pageSize:R}),ie=e.ajax.useGet("/roles",oe,[P,w,R],{setLoading:r,formatResult:function(e){return{dataSource:(null===e||void 0===e?void 0:e.list)||[],total:(null===e||void 0===e?void 0:e.total)||0}}}).data,le=(ie=void 0===ie?{}:ie).dataSource,ce=ie.total,se=e.ajax.useGet("/roleMenus"),ue=se.loading,Ae=se.run,de=e.ajax.useDel("/roles",null,{setLoading:r,successTip:"\u6279\u91cf\u5220\u9664\u6210\u529f\uff01"}).run,fe=[{title:"\u89d2\u8272\u540d",dataIndex:"name",width:150},{title:"\u63cf\u8ff0",dataIndex:"description"},{title:"\u64cd\u4f5c",dataIndex:"operator",width:100,render:function(e,n){var t=n.id,a=[{label:"\u7f16\u8f91",onClick:function(){return W(t)||$(!0)}},{label:"\u5220\u9664",color:"red",confirm:{title:"\u60a8\u786e\u5b9a\u5220\u9664\u5417\uff1f",onConfirm:function(){return function(e){return pe.apply(this,arguments)}(t)}}}];return Object(v.jsx)(p.a,{items:a})}}];function pe(){return(pe=Object(c.a)(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,de({ids:n},{successTip:"\u5220\u9664\u6210\u529f\uff01"});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function be(){return(be=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.a)(F.length);case 2:return e.next=4,de({ids:F.join(",")});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function me(){return(me=Object(c.a)(o.a.mark((function e(n){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return re(n),e.next=3,Ae({roleId:n.id});case 3:t=e.sent,Q(t);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var xe=!(null!==F&&void 0!==F&&F.length);return Object(v.jsxs)("div",{className:J.a.root,children:[Object(v.jsxs)(m.a,{fitHeight:!0,className:J.a.role,loading:a,children:[Object(v.jsx)(x.a,{children:Object(v.jsxs)(u.a,{name:"user",layout:"inline",form:ee,onFinish:function(e){Q([]),N([]),E(1),B(e)},children:[Object(v.jsx)(j.a,Object(s.a)(Object(s.a)({},{wrapperCol:{style:{width:200}}}),{},{label:"\u89d2\u8272\u540d\u79f0",name:"name"})),Object(v.jsx)(j.a,{children:Object(v.jsxs)(i.b,{children:[Object(v.jsx)(l.a,{type:"primary",htmlType:"submit",children:"\u67e5\u8be2"}),Object(v.jsx)(l.a,{htmlType:"reset",children:"\u91cd\u7f6e"})]})})]})}),Object(v.jsxs)(g.a,{children:[Object(v.jsx)(l.a,{type:"primary",onClick:function(){return W(null)||$(!0)},children:"\u6dfb\u52a0"}),Object(v.jsx)(l.a,{danger:!0,disabled:xe,onClick:function(){return be.apply(this,arguments)},children:"\u5220\u9664"})]}),Object(v.jsx)(y.a,{rowSelection:{selectedRowKeys:F,onChange:N},fitHeight:!0,dataSource:le,columns:fe,rowKey:"id",pagination:!1,onRow:function(e){return{onClick:function(){return function(e){return me.apply(this,arguments)}(e)}}},rowClassName:function(e){return(null===ae||void 0===ae?void 0:ae.id)===e.id?J.a.selectedRow:J.a.tableRow}}),Object(v.jsx)(O.a,{total:ce,pageNum:w,pageSize:R,onPageNumChange:E,onPageSizeChange:function(e){return E(1)||_(e)}}),Object(v.jsx)(C,{visible:U,isEdit:!!Y,id:Y,onOk:function(){return $(!1)||B(ee.getFieldsValue())},onCancel:function(){return $(!1)}})]}),Object(v.jsxs)("div",{className:J.a.menu,children:[Object(v.jsxs)(i.b,{className:J.a.menuTop,children:[Object(v.jsxs)("div",{children:["\u5f53\u524d\u9009\u4e2d\uff1a",null===ae||void 0===ae?void 0:ae.name]}),Object(v.jsx)(l.a,{type:"primary",disabled:!ae,children:"\u4fdd\u5b58"})]}),Object(v.jsx)("div",{className:J.a.menuContent,children:Object(v.jsx)(H,{loading:ue,fitHeight:!0,offsetHeight:-8,value:G,onChange:function(e){return Q(e)}})})]})]})}))},837:function(e,n,t){var a=t(165),r=t(838);"string"===typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var o={insert:"head",singleton:!1};a(r,o);e.exports=r.locals||{}},838:function(e,n,t){"use strict";t.r(n);var a=t(92),r=t.n(a)()(!0);r.push([e.i,".root_1lXHi {\n  display: flex;\n}\n.menu_ERmcs {\n  flex: 0 0 210px;\n  display: flex;\n  flex-direction: column;\n}\n.menu_ERmcs .menuTop_17CH7 {\n  flex: 0 0 50px;\n  display: flex;\n  align-items: center;\n  border-bottom: 1px solid #e8e8e8;\n}\n.menu_ERmcs .menuContent_ko9de {\n  flex: 1;\n  overflow: auto;\n}\n.edit_2vHXt {\n  flex: 1;\n  overflow: auto;\n  padding: 0 32px;\n  border-left: 1px solid #e8e8e8;\n  border-right: 1px solid #e8e8e8;\n}\n.edit_2vHXt h2 {\n  text-align: center;\n  padding: 8px;\n}\n.action_12t5u {\n  flex: 1;\n  overflow: auto;\n  padding: 0 32px;\n}\n.action_12t5u h2 {\n  text-align: center;\n  padding: 8px;\n}\n","",{version:3,sources:["webpack://src/pages/menus/style.less"],names:[],mappings:"AAAA;EACI,aAAA;AACJ;AAGA;EACI,eAAA;EACA,aAAA;EACA,sBAAA;AADJ;AAFA;EAMQ,cAAA;EACA,aAAA;EACA,mBAAA;EACA,gCAAA;AADR;AARA;EAaQ,OAAA;EACA,cAAA;AAFR;AAMA;EACI,OAAA;EACA,cAAA;EACA,eAAA;EACA,8BAAA;EACA,+BAAA;AAJJ;AADA;EAQQ,kBAAA;EACA,YAAA;AAJR;AASA;EACI,OAAA;EACA,cAAA;EACA,eAAA;AAPJ;AAIA;EAMQ,kBAAA;EACA,YAAA;AAPR",sourcesContent:[".root {\n    display: flex;\n\n}\n\n.menu {\n    flex: 0 0 210px;\n    display: flex;\n    flex-direction: column;\n\n    .menuTop {\n        flex: 0 0 50px;\n        display: flex;\n        align-items: center;\n        border-bottom: 1px solid #e8e8e8;\n    }\n\n    .menuContent {\n        flex: 1;\n        overflow: auto;\n    }\n}\n\n.edit {\n    flex: 1;\n    overflow: auto;\n    padding: 0 32px;\n    border-left: 1px solid #e8e8e8;\n    border-right: 1px solid #e8e8e8;\n\n    h2 {\n        text-align: center;\n        padding: 8px;\n    }\n\n}\n\n.action {\n    flex: 1;\n    overflow: auto;\n    padding: 0 32px;\n\n    h2 {\n        text-align: center;\n        padding: 8px;\n    }\n}\n"],sourceRoot:""}]),r.locals={root:"root_1lXHi",menu:"menu_ERmcs",menuTop:"menuTop_17CH7",menuContent:"menuContent_ko9de",edit:"edit_2vHXt",action:"action_12t5u"},n.default=r},882:function(e,n,t){"use strict";t(234);var a=t(77),r=(t(286),t(166)),o=(t(289),t(12)),i=t(0),l=t.n(i),c=t(9),s=t.n(c),u=t(34),A=t(296);function d(){return(d=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e}).apply(this,arguments)}function f(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function p(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?f(Object(t),!0).forEach((function(n){b(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):f(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function b(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function m(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var t=[],a=!0,r=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(a=(i=l.next()).done)&&(t.push(i.value),!n||t.length!==n);a=!0);}catch(c){r=!0,o=c}finally{try{a||null==l.return||l.return()}finally{if(r)throw o}}return t}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return x(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return x(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}function j(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var g=Object(i.forwardRef)((function(e,n){var t=Object(i.useContext)(u.b),c=Object(i.useContext)(o.a.ConfigContext).getPrefixCls(),s=e.children,f=e.fitHeight,b=e.otherHeight,x=e.style,g=e.bodyStyle,y=e.loading,O=e.loadingTip,h=void 0===O?t.loadingTip:O,v=e.prefixCls,C=void 0===v?t.prefixCls:v,w=e.fullScreen,E=e.footer,k=e.okHtmlType,S=e.okText,R=void 0===S?t.okText:S,_=e.cancelText,T=void 0===_?t.cancelText:_,I=e.onOk,H=e.onCancel,P=j(e,["children","fitHeight","otherHeight","style","bodyStyle","loading","loadingTip","prefixCls","fullScreen","footer","okHtmlType","okText","cancelText","onOk","onCancel"]),J=50;w&&(J=0,f=!0);var B=Object(i.useRef)(null),K=m(Object(A.a)(B,b||J),1)[0],D=p({display:"flex",flexDirection:"column",height:f?K:"auto"},x);return l.a.createElement(r.a,{spinning:y,tip:h},l.a.createElement("div",d({className:"".concat(C,"-modal-content"),ref:function(e){B.current=e,n&&(n.current=e)},style:D},P),l.a.createElement("div",{className:"".concat(C,"-modal-content-inner"),style:p({flex:1,padding:16,overflow:f||w?"auto":""},g)},s),!1!==E?l.a.createElement("div",{className:"".concat(c,"-modal-footer"),style:{flex:0}},E||l.a.createElement(l.a.Fragment,null,l.a.createElement(a.a,{type:"primary",onClick:I,htmlType:k},R),l.a.createElement(a.a,{onClick:H},T))):null))}));g.propTypes={fullScreen:s.a.bool,fitHeight:s.a.bool,otherHeight:s.a.number,loading:s.a.bool,loadingTip:s.a.any,footer:s.a.any,okHtmlType:s.a.any,okText:s.a.any,onOk:s.a.func,cancelText:s.a.any,onCancel:s.a.func,style:s.a.object,bodyStyle:s.a.object},g.defaultProps={loading:!1,style:{},bodyStyle:{},fitHeight:!1,okHtmlType:"",onOk:function(){},onCancel:function(){}},n.a=g},989:function(e,n,t){var a=t(165),r=t(990);"string"===typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var o={insert:"head",singleton:!1};a(r,o);e.exports=r.locals||{}},990:function(e,n,t){"use strict";t.r(n);var a=t(92),r=t.n(a)()(!0);r.push([e.i,".root_1ogAA {\n  display: flex;\n}\n.role_10A5n {\n  flex: 3;\n  padding: 8px;\n}\n.tableRow_3frRV,\n.selectedRow_2tWr_ {\n  cursor: pointer;\n}\n.selectedRow_2tWr_,\n.selectedRow_2tWr_:hover td {\n  background: #e8e8e8 !important;\n}\n.menu_31K2k {\n  flex: 2;\n  margin-top: 8px;\n  margin-right: 8px;\n  margin-bottom: 8px;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n.menuTop_3TJsl {\n  flex: 0 0 48px;\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n  padding: 8px;\n  margin-bottom: 8px;\n  background: #fff;\n}\n.menuContent_IDFBR {\n  flex: 1;\n  overflow: auto;\n  background: #fff;\n}\n","",{version:3,sources:["webpack://src/pages/role/style.less"],names:[],mappings:"AAAA;EACI,aAAA;AACJ;AAEA;EACI,OAAA;EACA,YAAA;AAAJ;AAGA;;EAEI,eAAA;AADJ;AAIA;;EAEI,8BAAA;AAFJ;AAKA;EACI,OAAA;EACA,eAAA;EACA,iBAAA;EACA,kBAAA;EACA,aAAA;EACA,sBAAA;EACA,YAAA;AAHJ;AAMA;EACI,cAAA;EACA,aAAA;EACA,yBAAA;EACA,mBAAA;EACA,YAAA;EACA,kBAAA;EACA,gBAAA;AAJJ;AAOA;EACI,OAAA;EACA,cAAA;EACA,gBAAA;AALJ",sourcesContent:[".root {\n    display: flex;\n}\n\n.role {\n    flex: 3;\n    padding: 8px;\n}\n\n.tableRow,\n.selectedRow {\n    cursor: pointer;\n}\n\n.selectedRow,\n.selectedRow:hover td {\n    background: #e8e8e8 !important;\n}\n\n.menu {\n    flex: 2;\n    margin-top: 8px;\n    margin-right: 8px;\n    margin-bottom: 8px;\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n}\n\n.menuTop {\n    flex: 0 0 48px;\n    display: flex;\n    justify-content: flex-end;\n    align-items: center;\n    padding: 8px;\n    margin-bottom: 8px;\n    background: #fff;\n}\n\n.menuContent {\n    flex: 1;\n    overflow: auto;\n    background: #fff;\n}\n"],sourceRoot:""}]),r.locals={root:"root_1ogAA",role:"role_10A5n",tableRow:"tableRow_3frRV",selectedRow:"selectedRow_2tWr_",menu:"menu_31K2k",menuTop:"menuTop_3TJsl",menuContent:"menuContent_IDFBR"},n.default=r}}]);
//# sourceMappingURL=8.d4f620ac.chunk.js.map